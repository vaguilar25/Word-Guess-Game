<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Hangman</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
    <link rel="stylesheet" type="text/css" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Creepster" rel="stylesheet">
</head>

<body id="image_background">
    <div class=container>


        <div class="row">
            <div class="col-sm-12 bg-success divHead  ">
                <h1 class="text-center header">Hangman Game</h1>
            </div>
        </div>
        <div class="row pt-5">
            <div class="col-sm-12">
                <h3 class="text-white"> Guess word: <span id="guessWord"></span></h3>
            </div>
        </div>
       
        <div class=row>
            <div class="col-sm-12">
                <h3 class="text-white"> Letters Already Used:<span id="letterUse"> </span></h3>
            </div>
        </div>
        <div class=row>
            <div class="col-sm-12">
                <h3 class="text-white"> Guesses Remainining:<span id="guessRemaining"> </span></h3>
            </div>
        </div>
        <div class=row>
            <div class="col-sm-12">
                <h3 class="text-white"> Winning Games:<span id="winningGames"> </span></h3>
            </div>
        </div>
        <div class="row pt-5">
            <div class=col-sm-4></div>
            <div class="col-sm-4 image_display" id="divImage">
                <img src="../Word-Guess-Game/assets/images/hangman.png">
            </div>
            <div class=col-sm-4></div>
        </div>



    </div>




    <script type="text/javascript">

        var gameLock = false;
        var userKeyPressed = "";  //Key pressed by the user
        var arrayOfLetters = [];  //array that stores the letters
        var countRemain = 0;      //keep track of the ramining tries
        var lettersUsed = [];     //array that stores the letters I have used
        var arrayOfAnswers = [];  //store the answer letters into array
        var listOfSpaces = " ";
        var countTotalGuess = 0;
        initializeGame();
        var countWins = 0;
        function initializeGame() {
            
            arrayOfWords = ["pink","metallica","timberlake","beyonce"];
            countRemain = 0;
            userKeyPressed = "";  //Key pressed by the user
            arrayOfLetters = [];  //array that stores the letters
            countRemain = 0;      //keep track of the ramining tries
            lettersUsed = [];     //array that stores the letters I have used
            arrayOfAnswers = [];  //store the answer letters into array
            countTotalGuess = 0;
            arrayOfLetters = []; 
            // var listOfSpaces = " ";
            document.getElementById("guessRemaining").innerHTML = "";
            document.getElementById("letterUse").innerHTML = "";
      
            document.getElementById("guessWord").innerHTML = "";

            ////
            wordToPlay = arrayOfWords[Math.floor(Math.random() * arrayOfWords.length)];
            displayWordSpaces(wordToPlay);

            arrayOfLetters = wordToPlay.split("");
            //Initialize the length of the array that is going to store the answers
            //var arrayOfAnswers = new Array(arrayOfLetters.length);
            console.log ("Initialize arrayOfLetters" + arrayOfLetters.length);
            console.log ("Initialize arrayOfAnswers" + arrayOfAnswers);

            //Initialize how many tries the user will have.. we increase with 5 the word length
            countRemain = arrayOfLetters.length + 5;
            // Create my object Game        


            console.log("initialize2 countRemain");
            ///
            gameLock = false;


        }

        document.onkeyup = function (event) {
            userKeyPressed = event.key;
            if (gameLock) {
                initializeGame();
                console.log("initialize3 - gameLock: " + gameLock);
            } else {
                console.log("User Key Press:" + userKeyPressed);

                //check if the user have used the letter
                var countMatch = 0;
                lettersUsed.forEach(function (element) {
                    if (userKeyPressed === element) {
                        countMatch++;
                    }
                });
                //If there is no match on the array insert the letter
                if (countMatch === 0) {
                    lettersUsed.push(userKeyPressed);
                }
                // Display letters used
                var lUsed = document.getElementById("letterUse");
                lUsed.textContent = lettersUsed;
                

                //If there is a match, replace the blank space tag with the user key Pressed letter
                correctKey = 0;
                console.log ("Array of letters: " + arrayOfLetters);

                var countInserted = 0;
                arrayOfLetters.forEach(function (element, index) {
                    //track the letters already inserted
                    
                    if (userKeyPressed === element) {
                        //Replace the content of the tag with the id=letteri
                        var tagName = "letter" + index;
                        var letterReplace = document.getElementById(tagName);
                        letterReplace.textContent = element;
                        
                        arrayOfAnswers[index] = element;
                        console.log ("arrayOfAnswers[index]" + arrayOfAnswers[index]);
                        //store the answers in an array
                       // arrayOfLetters.pop(element);
                        console.log("Array Of Answers: VA" + arrayOfAnswers);     
                        //arrayOfAnswers.push(element);  
                        //if (arrayOfAnswers.indexOf(userKeyPressed) === -1) {
                        //    arrayOfAnswers[index] = userKeyPressed;
                        //}
//ATENTION
                        //check if the word is completed then display win
                       var completedWord = arrayOfAnswers.join("");
                        if (completedWord === wordToPlay) {
                        // if (arrayOfAnswers.length === arrayOfLetters.length) {
                            var gRemaining = document.getElementById("guessRemaining");
                            gRemaining.textContent = "You Win";
                            countWins++;
                            gameLock = true;
                            console.log ("Number of Wins:" + countWins);
                            document.getElementById("winningGames").innerHTML = countWins;
                        }
                        // Increase if there is a match , this help us to reduce the number of tries
                        correctKey++;
                    }
                });


                //If there is not a match reduce tries remining
                console.log("correctKey: " + correctKey)
                if (correctKey === 0) {
                    countRemain = countRemain - 1;
                    var gRemaining = document.getElementById("guessRemaining");
                    gRemaining.textContent = countRemain;
                    console.log("newGame.countRemain: " + countRemain);
                    //check if we do not have more remaining trials, then display loose
                    if (countRemain === 0) {
                        var gRemaining = document.getElementById("guessRemaining");
                        gRemaining.textContent = "You Lost";

                        var imageDiv = document.getElementById("divImage");
                        imageDiv.style.display = "block";
                        // event.preventDefault();
                        gameLock = true;
                    }

                }

                
            }
        }
        //declaration of the object hangman
        function hangman(word, letUsed, cRemain) {
            this.wordPlay = word;
            this.lettersUsed = letUsed;
            this.countRemain = cRemain;

            //Function used to display spaces with _ inside HTML for the word to be guessed 
            this.displayWordSpaces = function (word) {

                var listOfSpaces = " ";

                for (i = 0; i < word.length; i++) {
                    // concatenate html to generate spaces
                    listOfSpaces += "<span id=letter" + i + "> _ </span>";

                }
                //send the html to the html tag in reference
                document.getElementById("guessWord").innerHTML = listOfSpaces;


            }

        }

        function displayWordSpaces(word) {
            var listOfSpaces = " ";

            for (i = 0; i < word.length; i++) {
                // concatenate html to generate spaces
                listOfSpaces += "<span id=letter" + i + "> _ </span>";

            }
            //send the html to the html tag in reference
            document.getElementById("guessWord").innerHTML = listOfSpaces;
        }

        function letterUsed (letterUsed,userKeyPressed) {
            var countMatch = 0;
                lettersUsed.forEach(function (element) {
                    if (userKeyPressed === element) {
                        countMatch++;
                    }
                });
                //If there is no match on the array insert the letter
                if (countMatch === 0) {
                    lettersUsed.push(userKeyPressed);
                }
                // Display letters used
                var lUsed = document.getElementById("letterUse");
                lUsed.textContent = lettersUsed;
        }

        console.log("initialize");







    </script>
</body>

</html>