<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Hangman</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
    <link rel="stylesheet" type="text/css" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">

</head>

<body id="image_background">
    <div class=container>


        <div class="row justify-content-center">
            <div class="col-sm-12 bg-success divHead  justify-content-center  ">
                <h1>Hangman Game</h1>
            </div>
        </div>
        <div class=row>
            <div class="col-sm-12">
                <h3 class="text-white"> Guess word: <span id="guessWord"></span></h3>
            </div>
        </div>
        <div class=row>
            <div class="col-sm-12">
                <h3 class="text-white"> Total Guesses: <span id="totalGuesses"></span></h3>
            </div>
        </div>
        <div class=row>
            <div class="col-sm-12">
                <h3 class="text-white"> Letters Already Used:<span id="letterUse"> </span></h3>
            </div>
        </div>
        <div class=row>
            <div class="col-sm-12">
                <h3 class="text-white"> Guesses Remainining:<span id="guessRemaining"> </span></h3>
            </div>
        </div>
        <div class=row>
                <div class="col-sm-12 image_display" id="divImage">
                    <img src="../Word-Guess-Game/assets/images/hangman.png"  > 
                </div>
         </div>

    </div>




    <script type="text/javascript">
        var userKeyPressed = "";  //Key pressed by the user
        var arrayOfLetters = [];  //array that stores the letters
        var countRemain = 0;      //keep track of the ramining tries
        var lettersUsed = [];     //array that stores the letters I have used
        var arrayOfAnswers = [];  //store the answer letters into array

        document.onkeyup = function (event) {
            userKeyPressed = event.key;
            console.log("User Key Press:" + userKeyPressed);

            //check if the user have used the letter
            var countMatch = 0;
            lettersUsed.forEach(function (element) {
                if (userKeyPressed === element) {
                    countMatch++;
                }
            });
            //If there is no match on the array insert the letter
            if (countMatch === 0) {
                lettersUsed.push(userKeyPressed);
            }
            // Display letters used
            var lUsed = document.getElementById("letterUse");
            lUsed.textContent = lettersUsed;


            //If there is a match, replace the blank space tag with the user key Pressed letter
            correctKey = 0;
            arrayOfLetters.forEach(function (element, index) {

                if (userKeyPressed === element) {
                    //Replace the content of the tag with the id=letteri
                    var tagName = "letter" + index;
                    var letterReplace = document.getElementById(tagName);
                    letterReplace.textContent = element;

                    //store the answers in an array
                    if (arrayOfAnswers.indexOf(userKeyPressed) === -1) {
                        arrayOfAnswers[index] = userKeyPressed;
                    }

                    //check if the word is completed then display win
                    var completedWord = arrayOfAnswers.join("");
                    if (completedWord === newGame.wordPlay) {
                        var gRemaining = document.getElementById("guessRemaining");
                        gRemaining.textContent = "You Win";
                    }
                    // Increase if there is a match , this help us to reduce the number of tries
                    correctKey++;
                }
            });


            //If there is not a match reduce tries remining
            if (correctKey === 0) {
                newGame.countRemain = newGame.countRemain - 1;
                var gRemaining = document.getElementById("guessRemaining");
                gRemaining.textContent = newGame.countRemain;
                //check if we do not have more remaining trials, then display loose
                if (newGame.countRemain === 0) {
                    var gRemaining = document.getElementById("guessRemaining");
                    gRemaining.textContent = "You Loose";

                    var imageDiv = document.getElementById("divImage");
                    imageDiv.style.display="block";
                }
            }

            //Count the total guesses
            var countTotalGuess = 0;
            arrayOfAnswers.forEach(function (element) {
                if (element !== "") {
                    countTotalGuess++;
                    console.log("Inside Loop Count Total: " + countTotalGuess);
                }
            });

            //Display the totalGuesses through the game
            var totalGuess = document.getElementById("totalGuesses");
            totalGuess.textContent = countTotalGuess;

        }

        //declaration of the object hangman
        function hangman(word, letUsed, cRemain) {
            this.wordPlay = word;
            this.lettersUsed = letUsed;
            this.countRemain = cRemain;

            //Function used to display spaces with _ inside HTML for the word to be guessed 
            this.displayWordSpaces = function (word) {

                var listOfSpaces = " ";

                for (i = 0; i < word.length; i++) {
                    // concatenate html to generate spaces
                    listOfSpaces += "<span id=letter" + i + "> _ </span>";

                }
                //send the html to the html tag in reference
                document.getElementById("guessWord").innerHTML = listOfSpaces;


            }

        }
        // Create my object Game        
        var newGame = new hangman(
            "push",
            0,
            0
        );

        newGame.displayWordSpaces(newGame.wordPlay);
        arrayOfLetters = newGame.wordPlay.split("");
        //Initialize the length of the array that is going to store the answers
        var arrayOfAnswers = new Array(arrayOfLetters.length);

        //Initialize how many tries the user will have.. we increase with 5 the word length
        newGame.countRemain = arrayOfLetters.length + 5;




    </script>
</body>

</html>